{% extends "main/base.html" %}

{% block title %}{{ action }} Settings - IdeaGraph v1.0{% endblock %}

{% block content %}
<div class="container">
    <div class="row mb-4 fade-in-up">
        <div class="col-lg-12">
            <div class="d-flex justify-content-between align-items-center">
                <div>
                    <h1 class="display-5 fw-bold mb-2" style="color: var(--autumn-light);">
                        <i class="bi bi-gear-fill" style="color: var(--autumn-accent);"></i>
                        {{ action }} Settings
                    </h1>
                    <p class="text-muted mb-0">
                        <i class="bi bi-shield-lock-fill"></i> Configure system settings and API keys
                    </p>
                </div>
                <div>
                    <a href="{% url 'main:settings_list' %}" class="btn btn-outline-primary">
                        <i class="bi bi-arrow-left"></i> Back to List
                    </a>
                </div>
            </div>
        </div>
    </div>

    <div class="row fade-in-up" style="animation-delay: 0.1s;">
        <div class="col-lg-12">
            <form method="post" class="card">
                {% csrf_token %}
                <div class="card-body">
                    <!-- OpenAI Configuration -->
                    <div class="mb-4">
                        <h5 class="mb-3" style="color: var(--autumn-accent);">
                            <i class="bi bi-robot"></i> OpenAI Configuration
                        </h5>
                        <div class="row">
                            <div class="col-md-12 mb-3">
                                <div class="form-check form-switch">
                                    <input 
                                        class="form-check-input" 
                                        type="checkbox" 
                                        id="openai_api_enabled" 
                                        name="openai_api_enabled"
                                        {% if settings.openai_api_enabled %}checked{% endif %}>
                                    <label class="form-check-label" for="openai_api_enabled">
                                        Enable OpenAI API
                                    </label>
                                    <div class="form-text">Enable OpenAI API integration</div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="openai_api_key" class="form-label">OPENAI_API_KEY</label>
                                <input 
                                    type="password" 
                                    class="form-control" 
                                    id="openai_api_key" 
                                    name="openai_api_key" 
                                    value="{{ settings.openai_api_key|default:'' }}"
                                    placeholder="sk-...">
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="openai_org_id" class="form-label">OPENAI_ORG_ID</label>
                                <input 
                                    type="text" 
                                    class="form-control" 
                                    id="openai_org_id" 
                                    name="openai_org_id" 
                                    value="{{ settings.openai_org_id|default:'' }}"
                                    placeholder="OpenAI Organisation ID">
                                <div class="form-text">OpenAI Organisation ID (optional)</div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="openai_api_base_url" class="form-label">OpenAI API Base URL</label>
                                <input 
                                    type="url" 
                                    class="form-control" 
                                    id="openai_api_base_url" 
                                    name="openai_api_base_url" 
                                    value="{{ settings.openai_api_base_url|default:'https://api.openai.com/v1' }}"
                                    placeholder="https://api.openai.com/v1">
                                <div class="form-text">OpenAI API base URL</div>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="openai_default_model" class="form-label">Default OpenAI Model</label>
                                <input 
                                    type="text" 
                                    class="form-control" 
                                    id="openai_default_model" 
                                    name="openai_default_model" 
                                    value="{{ settings.openai_default_model|default:'gpt-4' }}"
                                    placeholder="gpt-4">
                                <div class="form-text">Default model for OpenAI API (e.g., gpt-4, gpt-3.5-turbo)</div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="openai_api_timeout" class="form-label">OpenAI API Timeout</label>
                                <input 
                                    type="number" 
                                    class="form-control" 
                                    id="openai_api_timeout" 
                                    name="openai_api_timeout" 
                                    value="{{ settings.openai_api_timeout|default:30 }}"
                                    min="5" 
                                    max="300"
                                    placeholder="30">
                                <div class="form-text">Timeout for OpenAI API requests in seconds</div>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="openai_max_tokens" class="form-label">OpenAI Max Tokens per Request</label>
                                <input 
                                    type="number" 
                                    class="form-control" 
                                    id="openai_max_tokens" 
                                    name="openai_max_tokens" 
                                    value="{{ settings.openai_max_tokens|default:10000 }}"
                                    min="1000" 
                                    max="128000"
                                    placeholder="10000">
                                <div class="form-text">Maximum number of tokens to send per OpenAI API request (content will be chunked if larger)</div>
                            </div>
                        </div>
                    </div>

                    <hr style="border-color: var(--autumn-primary);">

                    <!-- Graph API Configuration -->
                    <div class="mb-4">
                        <h5 class="mb-3" style="color: var(--autumn-accent);">
                            <i class="bi bi-microsoft"></i> Graph API Configuration
                        </h5>
                        <div class="row">
                            <div class="col-md-12 mb-3">
                                <div class="form-check form-switch">
                                    <input 
                                        class="form-check-input" 
                                        type="checkbox" 
                                        id="graph_api_enabled" 
                                        name="graph_api_enabled"
                                        {% if settings.graph_api_enabled %}checked{% endif %}>
                                    <label class="form-check-label" for="graph_api_enabled">
                                        Enable Graph API
                                    </label>
                                    <div class="form-text">Enable Microsoft Graph API integration</div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-4 mb-3">
                                <label for="client_id" class="form-label">CLIENT_ID</label>
                                <input 
                                    type="text" 
                                    class="form-control" 
                                    id="client_id" 
                                    name="client_id" 
                                    value="{{ settings.client_id|default:'' }}"
                                    placeholder="GraphAPI Client ID">
                                <div class="form-text">GraphAPI Client ID</div>
                            </div>
                            <div class="col-md-4 mb-3">
                                <label for="client_secret" class="form-label">CLIENT_SECRET</label>
                                <input 
                                    type="password" 
                                    class="form-control" 
                                    id="client_secret" 
                                    name="client_secret" 
                                    value="{{ settings.client_secret|default:'' }}"
                                    placeholder="GraphAPI Client Secret">
                                <div class="form-text">GraphAPI Client Secret</div>
                            </div>
                            <div class="col-md-4 mb-3">
                                <label for="tenant_id" class="form-label">TENANT_ID</label>
                                <input 
                                    type="text" 
                                    class="form-control" 
                                    id="tenant_id" 
                                    name="tenant_id" 
                                    value="{{ settings.tenant_id|default:'' }}"
                                    placeholder="GraphAPI Tenant">
                                <div class="form-text">GraphAPI Tenant</div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="sharepoint_site_id" class="form-label">SharePoint Site ID</label>
                                <input 
                                    type="text" 
                                    class="form-control" 
                                    id="sharepoint_site_id" 
                                    name="sharepoint_site_id" 
                                    value="{{ settings.sharepoint_site_id|default:'' }}"
                                    placeholder="SharePoint site ID">
                                <div class="form-text">SharePoint site ID for document operations</div>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="default_mail_sender" class="form-label">Default Mail Sender</label>
                                <input 
                                    type="email" 
                                    class="form-control" 
                                    id="default_mail_sender" 
                                    name="default_mail_sender" 
                                    value="{{ settings.default_mail_sender|default:'' }}"
                                    placeholder="sender@example.com">
                                <div class="form-text">Default sender email for Graph API mail operations</div>
                            </div>
                        </div>
                    </div>

                    <hr style="border-color: var(--autumn-primary);">

                    <!-- GitHub Configuration -->
                    <div class="mb-4">
                        <h5 class="mb-3" style="color: var(--autumn-accent);">
                            <i class="bi bi-github"></i> GitHub Configuration
                        </h5>
                        <div class="row">
                            <div class="col-md-12 mb-3">
                                <div class="form-check form-switch">
                                    <input 
                                        class="form-check-input" 
                                        type="checkbox" 
                                        id="github_api_enabled" 
                                        name="github_api_enabled"
                                        {% if settings.github_api_enabled %}checked{% endif %}>
                                    <label class="form-check-label" for="github_api_enabled">
                                        Enable GitHub API
                                    </label>
                                    <div class="form-text">Enable GitHub API integration</div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-12 mb-3">
                                <label for="github_token" class="form-label">GITHUB_TOKEN</label>
                                <input 
                                    type="password" 
                                    class="form-control" 
                                    id="github_token" 
                                    name="github_token" 
                                    value="{{ settings.github_token|default:'' }}"
                                    placeholder="ghp_...">
                                <div class="form-text">GitHub PAT Key</div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="github_api_base_url" class="form-label">GitHub API Base URL</label>
                                <input 
                                    type="url" 
                                    class="form-control" 
                                    id="github_api_base_url" 
                                    name="github_api_base_url" 
                                    value="{{ settings.github_api_base_url|default:'https://api.github.com' }}"
                                    placeholder="https://api.github.com">
                                <div class="form-text">GitHub API base URL</div>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="github_default_owner" class="form-label">Default GitHub Owner</label>
                                <input 
                                    type="text" 
                                    class="form-control" 
                                    id="github_default_owner" 
                                    name="github_default_owner" 
                                    value="{{ settings.github_default_owner|default:'' }}"
                                    placeholder="username or organization">
                                <div class="form-text">Default owner for GitHub operations</div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="github_default_repo" class="form-label">Default GitHub Repository</label>
                                <input 
                                    type="text" 
                                    class="form-control" 
                                    id="github_default_repo" 
                                    name="github_default_repo" 
                                    value="{{ settings.github_default_repo|default:'' }}"
                                    placeholder="repository-name">
                                <div class="form-text">Default repository for GitHub operations</div>
                            </div>
                        </div>
                    </div>

                    <hr style="border-color: var(--autumn-primary);">

                    <!-- ChromaDB Configuration -->
                    <div class="mb-4">
                        <h5 class="mb-3" style="color: var(--autumn-accent);">
                            <i class="bi bi-database"></i> ChromaDB Configuration
                        </h5>
                        <div class="alert alert-warning" role="alert">
                            <i class="bi bi-exclamation-triangle-fill"></i> <strong>Derzeit nicht verfügbar</strong>
                            <p class="mb-0 mt-2">Die Cloud-basierte ChromaDB-Konfiguration ist derzeit nicht verfügbar. Das System verwendet eine lokale ChromaDB-Instanz.</p>
                        </div>
                        <div class="row">
                            <div class="col-md-4 mb-3">
                                <label for="chroma_api_key" class="form-label">CHROMA_API_KEY</label>
                                <input 
                                    type="password" 
                                    class="form-control" 
                                    id="chroma_api_key" 
                                    name="chroma_api_key" 
                                    value="{{ settings.chroma_api_key|default:'' }}"
                                    placeholder="ChromaDB Api Key"
                                    disabled>
                                <div class="form-text">ChromaDB Api Key (Cloud) - Derzeit nicht verfügbar</div>
                            </div>
                            <div class="col-md-4 mb-3">
                                <label for="chroma_database" class="form-label">CHROMA_DATABASE</label>
                                <input 
                                    type="text" 
                                    class="form-control" 
                                    id="chroma_database" 
                                    name="chroma_database" 
                                    value="{{ settings.chroma_database|default:'' }}"
                                    placeholder="Database name"
                                    disabled>
                                <div class="form-text">ChromaDB Database - Derzeit nicht verfügbar</div>
                            </div>
                            <div class="col-md-4 mb-3">
                                <label for="chroma_tenant" class="form-label">CHROMA_TENANT</label>
                                <input 
                                    type="text" 
                                    class="form-control" 
                                    id="chroma_tenant" 
                                    name="chroma_tenant" 
                                    value="{{ settings.chroma_tenant|default:'' }}"
                                    placeholder="Tenant name"
                                    disabled>
                                <div class="form-text">ChromaDB Tenant - Derzeit nicht verfügbar</div>
                            </div>
                        </div>
                    </div>

                    <hr style="border-color: var(--autumn-primary);">

                    <!-- Weaviate Configuration -->
                    <div class="mb-4">
                        <h5 class="mb-3" style="color: var(--autumn-accent);">
                            <i class="bi bi-database-fill-gear"></i> Weaviate Configuration
                        </h5>
                        <div class="row">
                            <div class="col-md-12 mb-3">
                                <div class="form-check form-switch">
                                    <input 
                                        class="form-check-input" 
                                        type="checkbox" 
                                        id="weaviate_cloud_enabled" 
                                        name="weaviate_cloud_enabled"
                                        {% if settings.weaviate_cloud_enabled %}checked{% endif %}>
                                    <label class="form-check-label" for="weaviate_cloud_enabled">
                                        Enable Weaviate Cloud
                                    </label>
                                    <div class="form-text">Enable Weaviate Cloud (if disabled, local configuration is used)</div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="weaviate_url" class="form-label">WEAVIATE_URL</label>
                                <input 
                                    type="url" 
                                    class="form-control" 
                                    id="weaviate_url" 
                                    name="weaviate_url" 
                                    value="{{ settings.weaviate_url|default:'' }}"
                                    placeholder="https://my-cluster.weaviate.network">
                                <div class="form-text">Weaviate Cloud URL (includes automatic gRPC support)</div>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="weaviate_api_key" class="form-label">WEAVIATE_API_KEY</label>
                                <input 
                                    type="password" 
                                    class="form-control" 
                                    id="weaviate_api_key" 
                                    name="weaviate_api_key" 
                                    value="{{ settings.weaviate_api_key|default:'' }}"
                                    placeholder="Weaviate Cloud API Key">
                                <div class="form-text">Weaviate Cloud API Key</div>
                            </div>
                        </div>
                        <div class="alert alert-info" role="alert">
                            <i class="bi bi-info-circle-fill"></i> <strong>gRPC Support</strong>
                            <p class="mb-0 mt-2">gRPC is automatically enabled with Weaviate Cloud for improved performance. The client handles port configuration (HTTPS on 443, gRPC on 50051) automatically.</p>
                        </div>
                    </div>

                    <hr style="border-color: var(--autumn-primary);">

                    <!-- KiGate Configuration -->
                    <div class="mb-4">
                        <h5 class="mb-3" style="color: var(--autumn-accent);">
                            <i class="bi bi-cpu"></i> KiGate Configuration
                        </h5>
                        <div class="row">
                            <div class="col-md-12 mb-3">
                                <div class="form-check form-switch">
                                    <input 
                                        class="form-check-input" 
                                        type="checkbox" 
                                        id="kigate_api_enabled" 
                                        name="kigate_api_enabled"
                                        {% if settings.kigate_api_enabled %}checked{% endif %}>
                                    <label class="form-check-label" for="kigate_api_enabled">
                                        Enable KiGate API
                                    </label>
                                    <div class="form-text">Enable KiGate API integration</div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="kigate_api_base_url" class="form-label">KiGate API Base URL</label>
                                <input 
                                    type="url" 
                                    class="form-control" 
                                    id="kigate_api_base_url" 
                                    name="kigate_api_base_url" 
                                    value="{{ settings.kigate_api_base_url|default:'http://localhost:8000' }}"
                                    placeholder="http://localhost:8000">
                                <div class="form-text">KiGate API base URL</div>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="kigate_api_token" class="form-label">KiGate API Token</label>
                                <input 
                                    type="password" 
                                    class="form-control" 
                                    id="kigate_api_token" 
                                    name="kigate_api_token" 
                                    value="{{ settings.kigate_api_token|default:'' }}"
                                    placeholder="client_id:client_secret">
                                <div class="form-text">KiGate API authentication token (client_id:client_secret)</div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="kigate_api_timeout" class="form-label">KiGate API Timeout</label>
                                <input 
                                    type="number" 
                                    class="form-control" 
                                    id="kigate_api_timeout" 
                                    name="kigate_api_timeout" 
                                    value="{{ settings.kigate_api_timeout|default:30 }}"
                                    min="5" 
                                    max="300"
                                    placeholder="30">
                                <div class="form-text">Timeout for KiGate API requests in seconds</div>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="kigate_max_tokens" class="form-label">KiGate Max Tokens per Request</label>
                                <input 
                                    type="number" 
                                    class="form-control" 
                                    id="kigate_max_tokens" 
                                    name="kigate_max_tokens" 
                                    value="{{ settings.kigate_max_tokens|default:10000 }}"
                                    min="1000" 
                                    max="128000"
                                    placeholder="10000">
                                <div class="form-text">Maximum number of tokens to send per KiGate API request (content will be chunked if larger)</div>
                            </div>
                        </div>
                    </div>

                    <hr style="border-color: var(--autumn-primary);">

                    <!-- Weaviate Configuration -->
                    <div class="mb-4">
                        <h5 class="mb-3" style="color: var(--autumn-accent);">
                            <i class="bi bi-cloud-fill"></i> Weaviate Configuration
                        </h5>
                        <div class="row">
                            <div class="col-md-12 mb-3">
                                <div class="form-check form-switch">
                                    <input 
                                        class="form-check-input" 
                                        type="checkbox" 
                                        id="weaviate_cloud_enabled" 
                                        name="weaviate_cloud_enabled"
                                        {% if settings.weaviate_cloud_enabled %}checked{% endif %}>
                                    <label class="form-check-label" for="weaviate_cloud_enabled">
                                        Cloud
                                    </label>
                                    <div class="form-text">Enable Weaviate Cloud (if disabled, local configuration is used)</div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="weaviate_url" class="form-label">WEAVIATE_URL</label>
                                <input 
                                    type="url" 
                                    class="form-control" 
                                    id="weaviate_url" 
                                    name="weaviate_url" 
                                    value="{{ settings.weaviate_url|default:'' }}"
                                    placeholder="https://your-cluster.weaviate.network">
                                <div class="form-text">Weaviate Cloud URL</div>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="weaviate_api_key" class="form-label">WEAVIATE_API_KEY</label>
                                <input 
                                    type="password" 
                                    class="form-control" 
                                    id="weaviate_api_key" 
                                    name="weaviate_api_key" 
                                    value="{{ settings.weaviate_api_key|default:'' }}"
                                    placeholder="Your Weaviate API Key">
                                <div class="form-text">Weaviate Cloud API Key</div>
                            </div>
                        </div>
                    </div>

                    <hr style="border-color: var(--autumn-primary);">

                    <!-- Microsoft SSO Configuration -->
                    <div class="mb-4">
                        <h5 class="mb-3" style="color: var(--autumn-accent);">
                            <i class="bi bi-microsoft"></i> SSO Microsoft Authentication
                        </h5>
                        <div class="row">
                            <div class="col-md-12 mb-3">
                                <div class="form-check form-switch">
                                    <input 
                                        class="form-check-input" 
                                        type="checkbox" 
                                        id="ms_sso_enabled" 
                                        name="ms_sso_enabled"
                                        {% if settings.ms_sso_enabled %}checked{% endif %}>
                                    <label class="form-check-label" for="ms_sso_enabled">
                                        Enable Microsoft SSO
                                    </label>
                                    <div class="form-text">Enable Microsoft Identity Single Sign-On authentication</div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="ms_sso_client_id" class="form-label">Client ID</label>
                                <input 
                                    type="text" 
                                    class="form-control" 
                                    id="ms_sso_client_id" 
                                    name="ms_sso_client_id" 
                                    value="{{ settings.ms_sso_client_id|default:'' }}"
                                    placeholder="Azure AD Application (Client) ID">
                                <div class="form-text">Microsoft Azure AD Application (Client) ID</div>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="ms_sso_tenant_id" class="form-label">Tenant ID</label>
                                <input 
                                    type="text" 
                                    class="form-control" 
                                    id="ms_sso_tenant_id" 
                                    name="ms_sso_tenant_id" 
                                    value="{{ settings.ms_sso_tenant_id|default:'' }}"
                                    placeholder="Azure AD Tenant ID">
                                <div class="form-text">Microsoft Azure AD Tenant ID</div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-12 mb-3">
                                <label for="ms_sso_client_secret" class="form-label">Client Secret (Optional)</label>
                                <input 
                                    type="password" 
                                    class="form-control" 
                                    id="ms_sso_client_secret" 
                                    name="ms_sso_client_secret" 
                                    value="{{ settings.ms_sso_client_secret|default:'' }}"
                                    placeholder="Azure AD Client Secret">
                                <div class="form-text">Microsoft Azure AD Client Secret (optional for some authentication flows)</div>
                            </div>
                        </div>
                    </div>

                    <hr style="border-color: var(--autumn-primary);">

                    <!-- Zammad Configuration -->
                    <div class="mb-4">
                        <h5 class="mb-3" style="color: var(--autumn-accent);">
                            <i class="bi bi-headset"></i> Zammad Configuration
                        </h5>
                        <div class="row">
                            <div class="col-md-12 mb-3">
                                <div class="form-check form-switch">
                                    <input 
                                        class="form-check-input" 
                                        type="checkbox" 
                                        id="zammad_enabled" 
                                        name="zammad_enabled"
                                        {% if settings.zammad_enabled %}checked{% endif %}>
                                    <label class="form-check-label" for="zammad_enabled">
                                        Enable Zammad Integration
                                    </label>
                                    <div class="form-text">Enable Zammad ticket synchronization</div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="zammad_api_url" class="form-label">Zammad API URL</label>
                                <input 
                                    type="url" 
                                    class="form-control" 
                                    id="zammad_api_url" 
                                    name="zammad_api_url" 
                                    value="{{ settings.zammad_api_url|default:'' }}"
                                    placeholder="https://your-zammad-instance.com">
                                <div class="form-text">Base URL of the Zammad instance</div>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="zammad_api_token" class="form-label">Zammad API Token</label>
                                <input 
                                    type="password" 
                                    class="form-control" 
                                    id="zammad_api_token" 
                                    name="zammad_api_token" 
                                    value="{{ settings.zammad_api_token|default:'' }}"
                                    placeholder="API token for authentication">
                                <div class="form-text">API token for authentication</div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="zammad_groups" class="form-label">Zammad Groups</label>
                                <textarea 
                                    class="form-control" 
                                    id="zammad_groups" 
                                    name="zammad_groups" 
                                    rows="3"
                                    placeholder="Support, Development, Maintenance">{{ settings.zammad_groups|default:'' }}</textarea>
                                <div class="form-text">Comma-separated list of group names to monitor</div>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="zammad_sync_interval" class="form-label">Zammad Sync Interval</label>
                                <input 
                                    type="number" 
                                    class="form-control" 
                                    id="zammad_sync_interval" 
                                    name="zammad_sync_interval" 
                                    value="{{ settings.zammad_sync_interval|default:15 }}"
                                    min="5" 
                                    max="1440"
                                    placeholder="15">
                                <div class="form-text">Interval in minutes for periodic synchronization</div>
                            </div>
                        </div>
                    </div>

                    <hr style="border-color: var(--autumn-primary);">

                    <!-- Google PSE Configuration -->
                    <div class="mb-4">
                        <h5 class="mb-3" style="color: var(--autumn-accent);">
                            <i class="bi bi-google"></i> Google PSE Configuration
                        </h5>
                        <div class="row">
                            <div class="col-md-12 mb-3">
                                <div class="form-check form-switch">
                                    <input 
                                        class="form-check-input" 
                                        type="checkbox" 
                                        id="google_pse_enabled" 
                                        name="google_pse_enabled"
                                        {% if settings.google_pse_enabled %}checked{% endif %}>
                                    <label class="form-check-label" for="google_pse_enabled">
                                        Enable Google PSE
                                    </label>
                                    <div class="form-text">Enable Google Programmable Search Engine integration for external support analysis</div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="google_search_api_key" class="form-label">Google Search API Key</label>
                                <input 
                                    type="password" 
                                    class="form-control" 
                                    id="google_search_api_key" 
                                    name="google_search_api_key" 
                                    value="{{ settings.google_search_api_key|default:'' }}"
                                    placeholder="Google Custom Search API Key">
                                <div class="form-text">Google Custom Search API Key</div>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="google_search_cx" class="form-label">Google Search CX</label>
                                <input 
                                    type="text" 
                                    class="form-control" 
                                    id="google_search_cx" 
                                    name="google_search_cx" 
                                    value="{{ settings.google_search_cx|default:'' }}"
                                    placeholder="Google Custom Search Engine ID">
                                <div class="form-text">Google Custom Search Engine ID (CX)</div>
                            </div>
                        </div>
                    </div>

                    <hr style="border-color: var(--autumn-primary);">

                    <!-- Additional Settings -->
                    <div class="mb-4">
                        <h5 class="mb-3" style="color: var(--autumn-accent);">
                            <i class="bi bi-sliders"></i> Additional Settings
                        </h5>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="max_tags_per_idea" class="form-label">MAX_TAGS_PER_IDEA</label>
                                <input 
                                    type="number" 
                                    class="form-control" 
                                    id="max_tags_per_idea" 
                                    name="max_tags_per_idea" 
                                    value="{{ settings.max_tags_per_idea|default:5 }}"
                                    min="1" 
                                    max="20">
                                <div class="form-text">Anzahl der Tags die bei Items durch die KI gesucht werden sollen</div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="card-footer text-end">
                    <a href="{% url 'main:settings_list' %}" class="btn btn-outline-secondary">
                        <i class="bi bi-x-circle"></i> Cancel
                    </a>
                    <button type="submit" class="btn btn-primary">
                        <i class="bi bi-check-circle-fill"></i> {{ action }} Settings
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>
{% endblock %}
